# Gitleaks configuration for detecting secrets
title = "Gitleaks Configuration"

[allowlist]
description = "Global allowlist for Lovable Cloud managed files"

# Allow .env.example as it contains only placeholders
paths = [
  '''^\.env\.example$''',
  '''^.*\.example$''',
]

# Allow Lovable Cloud auto-managed files (these are not committed in production)
# Note: .env and supabase/config.toml are auto-generated by Lovable Cloud
# and should be in .gitignore for production repositories
regexes = [
  '''# Lovable Cloud managed''',
  '''your-project-id''',
  '''your-anon-or-public-key''',
  '''<project-ref>''',
]

[[rules]]
id = "supabase-anon-key"
description = "Supabase Anonymous/Publishable Key"
regex = '''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9\.[A-Za-z0-9_-]+\.[A-Za-z0-9_-]+'''
tags = ["key", "supabase"]

[[rules]]
id = "supabase-service-role-key"
description = "Supabase Service Role Key (Critical)"
regex = '''SUPABASE_SERVICE_ROLE_KEY.*[=:]\s*["']?(eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9\.[A-Za-z0-9_-]+\.[A-Za-z0-9_-]+)["']?'''
tags = ["key", "supabase", "critical"]

[[rules]]
id = "generic-api-key"
description = "Generic API Key"
regex = '''(?i)(api[_-]?key|apikey|api[_-]?secret).*[=:]\s*["']?([a-z0-9_\-]{32,})["']?'''
tags = ["key", "api"]
